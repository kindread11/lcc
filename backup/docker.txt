flask
flask-socketio
eventlet
flask-login
werkzeug
sqlalchemy
pymysql


# 1) 디렉터리 생성
sudo mkdir -p /opt/localchat
cd /opt/localchat

# 2) 위 4개 파일 저장
# - app.py
# - requirements.txt
# - Dockerfile
# - docker-compose.yml

# 3) Docker/Compose 설치(없으면 배포판 가이드에 따라 설치)
#    예: Ubuntu -> apt install docker.io docker-compose-plugin
#        Rocky -> dnf install docker docker-compose-plugin && systemctl enable --now docker

# 4) 빌드 및 기동
sudo docker compose up -d --build

# 5) 접속
# 브라우저에서 http://<서버IP>:8000 → /setup 자동 이동 → 최초 관리자 계정 생성




# /etc/systemd/system/localchat-compose.service
[Unit]
Description=LocalChat via Docker Compose
After=network-online.target docker.service
Wants=network-online.target
Requires=docker.service

[Service]
Type=oneshot
WorkingDirectory=/opt/localchat
ExecStart=/usr/bin/docker compose up -d
ExecStop=/usr/bin/docker compose down
RemainAfterExit=yes
TimeoutStartSec=0

[Install]
WantedBy=multi-user.target


sudo systemctl daemon-reload
sudo systemctl enable --now localchat-compose.service
sudo systemctl status localchat-compose.service





# db 컨테이너 상태/로그
sudo docker ps
sudo docker logs localchat-db

# app 컨테이너 로그
sudo docker logs localchat-app

# 쉘 진입
sudo docker exec -it localchat-app bash
sudo docker exec -it localchat-db  mysql -ulc_user -plc_pass -e "SHOW DATABASES;"
